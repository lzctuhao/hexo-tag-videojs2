/*! @name videojs-mobile-ui @version 0.7.0 @license MIT */
function LongTab(e){const t=e.parentElement.getElementsByTagName("video")[0],n=e.parentElement.getElementsByClassName("toast_text")[0];let o,i,r=1;!function(e,n,r,a){let u,d,p=0,f=!1;e.ontouchstart=(r=>{c=0,s=r.touches[0].pageX,l=r.touches[0].pageY,u=e.clientWidth,d=e.clientHeight,o=t.currentTime,i=t.volume,p=0,r.preventDefault(),p=setTimeout(()=>{f=!0,n(),p=0},1e3)}),e.ontouchmove=(t=>{if(!f){clearTimeout(p),p=0;let n=t.changedTouches[0].pageX,o=t.changedTouches[0].pageY,i=n-s,r=o-l;a(e,u,n,i,d,o,r)}}),e.ontouchend=(()=>{p?clearTimeout(p):r()})}(e,function(){r=t.playbackRate,t.playbackRate=3},function(){t.playbackRate=r,u=a,n.style.opacity=0},function(e,r,s,d,p,f,h){let m=s/r,y=d/r,g=f/p,v=h/p;function b(){c=1;let i=t.duration,r=y*i*.8;t.currentTime=o+r,n.innerHTML=function(e){var t="",n=parseInt(e/3600),o=parseInt(e%3600/60),i=parseInt(e%3600%60);n>0&&(t+=(n=n<10?"0"+n:n)+":");return t+=(o=o<10?"0"+o:o)+":"+(i=i<10?"0"+i:i)}(t.currentTime),n.style.opacity=1,e.parentElement.getElementsByClassName("vjs-control-bar")[0].getElementsByClassName("vjs-progress-control")[0].getElementsByClassName("vjs-play-progress")[0].style.width=t.currentTime/i*100+"%"}function T(){c=2;let e=-v;t.volume=function(e,n=0,o=1){return e>=o?(l=g*p,i=t.volume,o):e<=n?(l=g*p,i=t.volume,n):e.toFixed(2)}(i+e),n.innerHTML="音量: "+parseInt(100*t.volume)+"%",n.style.opacity=1}function _(){c=3,a=function(e,t=.5,n=1.1){return e>=n?(l=g*p,u=a,n):e<=t?(l=g*p,u=a,t):e}(u-.8*v),t.parentElement.style.filter="brightness("+a+")",n.innerHTML="亮度: "+parseInt(100*a)+"%",n.style.opacity=1}switch(c){case 0:Math.abs(y)>.1?b():m>.67&&Math.abs(v)>.1?T():m<.33&&Math.abs(v)>.1&&_();break;case 1:b();break;case 2:T();break;case 3:_()}});let a,s,l,u=1,c=0}function change_key_poster(){Array.prototype.slice.call(document.getElementsByTagName("video")).forEach(e=>{"/libs/videojs2/key.png"==e.getAttribute("poster")&&e.setAttribute("poster","/libs/videojs2/key_mobile.png")})}!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("video.js"),require("global/window")):"function"==typeof define&&define.amd?define(["video.js","global/window"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).videojsMobileUi=t(e.videojs,e.window)}(this,function(e,t){"use strict";function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=n(e),i=n(t);function r(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var a=r(function(e){function t(n,o){return e.exports=t=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},e.exports.default=e.exports,e.exports.__esModule=!0,t(n,o)}e.exports=t,e.exports.default=e.exports,e.exports.__esModule=!0}),s=r(function(e){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,a(e,t)},e.exports.default=e.exports,e.exports.__esModule=!0}),l=o.default.getComponent("Component"),u=o.default.dom||o.default,c=function(e){function t(t,n){var o;return(o=e.call(this,t,n)||this).seekSeconds=n.seekSeconds,o.tapTimeout=n.tapTimeout,o.addChild("playToggle",{}),t.on(["playing","userinactive"],function(e){o.removeClass("show-play-toggle")}),0===o.player_.options_.inactivityTimeout&&(o.player_.options_.inactivityTimeout=5e3),o.enable(),o}s(t,e);var n=t.prototype;return n.createEl=function(){return window.overlay_ele=u.createEl("div",{className:"vjs-touch-overlay",tabIndex:-1}),window.overlay_ele},n.handleTap=function(e){var t=this;e.target===this.el_&&(e.preventDefault(),this.firstTapCaptured?(this.firstTapCaptured=!1,this.timeout&&i.default.clearTimeout(this.timeout),this.handleDoubleTap(e)):(this.firstTapCaptured=!0,this.timeout=i.default.setTimeout(function(){t.firstTapCaptured=!1,t.handleSingleTap(e)},this.tapTimeout)))},n.handleSingleTap=function(e){this.removeClass("skip"),this.toggleClass("show-play-toggle")},n.handleDoubleTap=function(e){var t=this,n=this.el_.getBoundingClientRect(),o=e.changedTouches[0].clientX-n.left;if(o<.4*n.width)this.player_.currentTime(Math.max(0,this.player_.currentTime()-this.seekSeconds)),this.addClass("reverse");else{if(!(o>n.width-.4*n.width))return;this.player_.currentTime(Math.min(this.player_.duration(),this.player_.currentTime()+this.seekSeconds)),this.removeClass("reverse")}this.removeClass("show-play-toggle"),this.removeClass("skip"),i.default.requestAnimationFrame(function(){t.addClass("skip")})},n.enable=function(){this.firstTapCaptured=!1,this.on("touchend",this.handleTap)},n.disable=function(){this.off("touchend",this.handleTap)},t}(l);l.registerComponent("TouchOverlay",c);var d={fullscreen:{enterOnRotate:!0,exitOnRotate:!0,lockOnRotate:!0,iOS:!1,disabled:!1},touchControls:{seekSeconds:10,tapTimeout:300,disableOnEnd:!1,disabled:!1}},p=i.default.screen,f=o.default.registerPlugin||o.default.plugin,h=function(e){var t=this;void 0===e&&(e={}),(e.forceForTesting||o.default.browser.IS_ANDROID||o.default.browser.IS_IOS)&&this.ready(function(){change_key_poster(),function(e,t){if(e.addClass("vjs-mobile-ui"),t.fullscreen.iOS&&(o.default.log.warn("videojs-mobile-ui: `fullscreen.iOS` is deprecated. Use Video.js option `preferFullWindow` instead."),o.default.browser.IS_IOS&&o.default.browser.IOS_VERSION>9&&!e.el_.ownerDocument.querySelector(".bc-iframe")&&(e.tech_.el_.setAttribute("playsinline","playsinline"),e.tech_.supportsFullScreen=function(){return!1})),!t.touchControls.disabled){var n;(t.touchControls.disableOnEnd||"function"==typeof e.endscreen)&&e.addClass("vjs-mobile-ui-disable-end");var r=o.default.VERSION.split("."),a=parseInt(r[0],10),s=parseInt(r[1],10);n=a<7||7===a&&s<7?Array.prototype.indexOf.call(e.el_.children,e.getChild("ControlBar").el_):e.children_.indexOf(e.getChild("ControlBar")),e.touchOverlay=e.addChild("TouchOverlay",t.touchControls,n)}if(LongTab(e.touchOverlay.el_),!t.fullscreen.disabled){var l=!1,u=function(){var n=function(){if(p){var e=((p.orientation||{}).type||p.mozOrientation||p.msOrientation||"").split("-")[0];if("landscape"===e||"portrait"===e)return e}return"number"==typeof i.default.orientation?0===i.default.orientation||180===i.default.orientation?"portrait":"landscape":"portrait"}();"landscape"===n&&t.fullscreen.enterOnRotate?!1===e.paused()&&(e.requestFullscreen(),t.fullscreen.lockOnRotate&&p.orientation&&p.orientation.lock&&p.orientation.lock("landscape").then(function(){l=!0}).catch(function(e){o.default.log("Browser refused orientation lock:",e)})):"portrait"===n&&t.fullscreen.exitOnRotate&&!l&&e.isFullscreen()&&e.exitFullscreen()};(t.fullscreen.enterOnRotate||t.fullscreen.exitOnRotate)&&(o.default.browser.IS_IOS?(i.default.addEventListener("orientationchange",u),e.on("dispose",function(){i.default.removeEventListener("orientationchange",u)})):p.orientation&&(p.orientation.onchange=u,e.on("dispose",function(){p.orientation.onchange=null})),e.on("fullscreenchange",function(t){!e.isFullscreen()&&l&&(p.orientation.unlock(),l=!1)})),e.on("ended",function(e){!0===l&&(p.orientation.unlock(),l=!1)})}}(t,o.default.mergeOptions(d,e))})};return f("mobileUi",h),h.VERSION="0.7.0",h});